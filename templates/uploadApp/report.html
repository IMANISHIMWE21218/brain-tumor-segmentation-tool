{% extends '../layout.html' %}
{% load static %}
{% block content %}

<style>
	.top-bar{
		display: inline;
	}
	.btn{
		margin-top: 15px;
	}
	.btn:hover{
         background-color: rgba(28, 87, 118, 0.315);
	}
</style>
<div class="top-bar">
	<div class="text-start">
		<h1 class="text-xl font-bold text-gray-700 py-6 ">RESULTS</h1>
	</div>


	<div  class="text-end">
	
	 <!-- Search form -->
	 <form class="navbar-search form-inline" id="navbar-search-main">
		<div class="form-outline">
		<input type="search" id="form1" name="q" class="form-control" placeholder="Type here To Search" aria-label="Search" />
		</div>
		</form>
	<!-- / Search form -->
		<a href="{% url 'pdf_report' %}" target="_blank" class="btn btn-outline-gray-600 d-inline-flex align-items-center">
			PDF REPORT
		</a>
	</div>

</div>


<div class="text-gray-700 flex w-full space-x-2 my-6">
	<div class="text-gray-700  w-full">
		<table id="dtBasicExample" class="border-collapse border-b border-slate-400 w-full table table-striped table-bordered table-sm">
			<thead class="bg-sky-800 text-white">
				<tr>
					<th class="border border-slate-300 p-2">Name</th>
					<th class="border border-slate-300 p-2">Email</th>
					<th class="border border-slate-300 p-2">Phone</th>
					<th class="border border-slate-300 p-2">Published on</th>
					<th class="border border-slate-300 p-2"></th>
				</tr>
			</thead>
			<tbody>
				{% for patient in patients %}
				<!-- Modal -->

				<tr>
					<td class="border-b border-slate-300 p-2 text-center">
						{{patient.first_name}} {{patient.last_name}}
					</td>
					<td class="border-b border-slate-300 p-2 text-center">
						{{patient.email}}
					</td>
					<td class="border-b border-slate-300 p-2 text-center">
						{{patient.phone_number}}
					</td>
					<td class="border-b border-slate-300 p-2 text-center">
						{{patient.created_on | date:"M d, Y - H:i"}}
					</td>
					<td class="border-b border-slate-300 p-2 text-center">
						<button data-bs-toggle="modal" data-bs-target="#exampleModalToggle{{patient.id}}"
							class="p-1 border-sky-500 hover:border-gray-500 border text-sky-800 hover:text-sky-500 cursor-pointer">Comment</button>
					</td>
				</tr>
				<div class="modal fade" id="exampleModalToggle{{patient.id}}" tabindex="-1"
					aria-labelledby="exampleModalLabel" aria-hidden="true">
					<div class="modal-dialog modal-dialog-centered w-10/12">
						<div class="modal-content">
							<div class="modal-header">
								<h5 class="modal-title" id="exampleModalLabel{{patient.id}}">Patient Details</h5>
								<button type="button" class="btn-close" data-bs-dismiss="modal"
									aria-label="Close"></button>
							</div>
							<div class="modal-body">
								<div class="flex space-x-2">
									<a target="_blank" href="{{ patient.original_image.url}}"><img
											src="{{ patient.original_image.url}}" alt="{{patient.email}}"
											class="object-cover" width="150px" /></a>
									<a target="_blank" href="{{ patient.original_image.url}}"><img
											src="{{ patient.original_image.url}}" alt="{{patient.email}}"
											class="object-cover" width="150px" /></a>

								</div>
								<div class="p-2">
									<div>
										Name: {{patient.first_name}} {{patient.last_name}}
									</div>
									<div>
										Created at: {{patient.created_on | date:"M d, Y - H:i"}}
									</div>
									<form action="{% url 'comment' patient.id %}" method="post">
										<div class="py-2">

											{% csrf_token %}
											{% for field in reportForm %}
											<textarea id="{{ field.id_for_label }}" name="{{ field.html_name }}"
												placeholder="{{field.label}}" required id="message" rows="4"
												class="block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
												placeholder="Your message..."></textarea>
											{% endfor %}

										</div>

										<button type="submit" class="btn btn-outline-gray-600 d-inline-flex align-items-center">COMMENT</button>
										<a href="/pdfsingle_report/{{patient.id}} " target="_blank" class="btn btn-outline-gray-600 d-inline-flex align-items-center">  PDF</a>
									</form>
									
								</div>
								<div>
									{% for comment in patient.comments.all %}
									  <div class="p-1 border mb-1">
										{{comment.doctor_comment}}
									  </div>
									{% endfor %}
								</div>
							</div>
							<div class="modal-footer">
								<button type="button"
									class="p-1 border-sky-500 hover:border-purple-500 border text-red-500 hover:text-gray-500 cursor-pointer"
									data-bs-dismiss="modal">Close</button>

							</div>
						</div>
					</div>
				</div>
				{% endfor %}
			</tbody>
		</table>
	</div>

</div>
<script>
    $(document).ready(function () {
      $('#dtBasicExample').DataTable();
      $('.dataTables_length').addClass('bs-select');
    });
  </script>
{% endblock content %}